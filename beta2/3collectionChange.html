<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<script type="text/javascript" src="http://code.jquery.com/jquery.js"></script>
	<script src="jquery.datalink2.js" type="text/javascript"></script>
	<script src="jquery.tmpl2.js" type="text/javascript"></script>
	<style type="text/css">
		table { border-collapse: collapse; }
		td { padding: 6px; }
		.r-o { border: 2px darkblue solid; }
		.row1 { border: 2px darkblue solid; border-bottom: 0px; }
		.row2 { border: 2px darkblue solid; border-top: 0px; }
	</style>
</head>
<body>
	<button onclick="showData()">show data</button>

	<button onclick="setName()">set name</button>
	<button onclick="append()">append</button>
	<button onclick="deleteLast()">delete last row</button>
	<hr /><br />

	<table id="peopleGrid">
	<tbody>
		<tr class="row1" data-jq-path="0">
			<td>
				<button class="btnDelete">X</button>
				Name: <span data-jq-linkfrom="firstName"></span> <span data-jq-linkfrom="lastName"></span>
			</td>
		</tr>
		<tr class="row2" data-jq-path="0">
			<td>
				<input data-jq-linkto="firstName" data-jq-linkfrom="firstName" />
				<input data-jq-linkto="lastName" data-jq-linkfrom="lastName" />
			</td>
		</tr>
		<tr class="row1" data-jq-path="1">
			<td>
				<button class="btnDelete">X</button>
				Name: <span data-jq-linkfrom="firstName"></span> <span data-jq-linkfrom="lastName"></span>
			</td>
		</tr>
		<tr class="row2" data-jq-path="1">
			<td>
				<input data-jq-linkto="firstName" data-jq-linkfrom="firstName" />
				<input data-jq-linkto="lastName" data-jq-linkfrom="lastName" />
			</td>
		</tr>
		<tr class="row1" data-jq-path="2">
			<td>
				<button class="btnDelete">X</button>
				Name: <span data-jq-linkfrom="firstName"></span> <span data-jq-linkfrom="lastName"></span>
			</td>
		</tr>
		<tr class="row2" data-jq-path="2">
			<td>
				<input data-jq-linkto="firstName" data-jq-linkfrom="firstName" />
				<input data-jq-linkto="lastName" data-jq-linkfrom="lastName" />
			</td>
		</tr>
	</tbody>
	</table>

	<script id="personTmpl" type="text/x-jquery-tmpl">
		<tr class="row1">
			<td>
				<button class="btnDelete">X</button>
				Name: <span data-jq-linkfrom="firstName"></span> <span data-jq-linkfrom="lastName"></span>
			</td>
		</tr>
		<tr class="row2">
			<td>
				<input data-jq-linkto="firstName" data-jq-linkfrom="firstName" />
				<input data-jq-linkto="lastName" data-jq-linkfrom="lastName" />
			</td>
		</tr>
	</script>

	<script type="text/javascript">
		var people = [
			{
				firstName: "Jo",
				lastName: "Proctor"
			},
			person2 = {
				firstName: "Maria",
				lastName: "Garcia"
			},
			person3 = {
				firstName: "Josh",
				lastName: "Evetsky"
			}
		];

		$.dataLink( people, "#peopleGrid", { tmpl: "#personTmpl" }).pushValues();

		$.dataLink( "#peopleGrid", people );

		$( "#peopleGrid" )
			.delegate( ".btnDelete", "click", function() {

				var index = $.viewItem( this ).index;
				$.changeArray( people, "splice", index, 1 );

			});

		function setName() {
			$.setField( people[0], "lastName", "Greenford" );
		}

		function append() {
			$.changeArray( people, "push", {
				firstName: "NewFirst",
				lastName: "NewLast"
			});
		}

		function deleteLast() {
			$.changeArray( people, "pop" );
		}

	</script>

	<!--Console-->

	<script id="showData" type="text/x-jquery-tmpl">
		<div>${firstName} ${lastName}</div>
	</script>

	<br /><hr />
	<b>Console</b>

	<div id="console"></div>
	<script type="text/javascript">
		function showData() {
			$( "#console" ).append("-----------------");
			$( "#showData" ).tmpl( people ).appendTo( "#console" );
		}
	</script>

</body>
</html>
